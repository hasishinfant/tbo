{"version":3,"file":"destination-features-rioVTb2Z.js","sources":["../../src/components/shared/ErrorBoundary.tsx","../../src/components/shared/NetworkStatus.tsx","../../src/components/shared/LoadingSpinner.tsx","../../src/components/shared/GlobalLoadingManager.tsx","../../src/components/shared/Icon.tsx","../../src/components/shared/Button.tsx","../../src/hooks/usePerformance.ts","../../src/components/shared/LazyImage.tsx","../../src/services/api.ts","../../src/hooks/useLoadingStates.ts","../../src/confidence-engine/services/apiClient.ts","../../src/confidence-engine/services/confidenceScoreService.ts","../../src/confidence-engine/services/mockConfidenceService.ts","../../src/confidence-engine/components/ConfidenceBadge.tsx","../../src/confidence-engine/components/ConfidenceBreakdownModal.tsx","../../src/confidence-engine/services/preferenceLearningService.ts","../../src/components/destination/DestinationCard.tsx","../../src/confidence-engine/hooks/useConfidenceScore.ts","../../src/components/destination/VRModal.tsx","../../src/components/destination/DestinationGrid.tsx"],"sourcesContent":["// Error boundary component\nimport React, { Component, ReactNode } from 'react';\n\ninterface Props {\n  children: ReactNode;\n}\n\ninterface State {\n  hasError: boolean;\n  error?: Error;\n}\n\nclass ErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = { hasError: false };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return { hasError: true, error };\n  }\n\n  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\n    console.error('Error caught by boundary:', error, errorInfo);\n  }\n\n  render() {\n    if (this.state.hasError) {\n      return (\n        <div className=\"error-boundary\" style={{\n          padding: '40px',\n          textAlign: 'center',\n          maxWidth: '600px',\n          margin: '100px auto',\n          backgroundColor: '#fff',\n          borderRadius: '12px',\n          boxShadow: '0 4px 12px rgba(0,0,0,0.1)'\n        }}>\n          <h2 style={{ color: '#e74c3c', marginBottom: '16px' }}>Something went wrong</h2>\n          <p style={{ marginBottom: '24px', color: '#666' }}>We're sorry, but something unexpected happened.</p>\n          {this.state.error && (\n            <details style={{ \n              marginBottom: '24px', \n              textAlign: 'left', \n              padding: '16px',\n              backgroundColor: '#f8f9fa',\n              borderRadius: '8px',\n              fontSize: '14px'\n            }}>\n              <summary style={{ cursor: 'pointer', fontWeight: 'bold', marginBottom: '8px' }}>\n                Error Details\n              </summary>\n              <pre style={{ \n                whiteSpace: 'pre-wrap', \n                wordBreak: 'break-word',\n                color: '#e74c3c',\n                fontSize: '12px'\n              }}>\n                {this.state.error.toString()}\n                {'\\n\\n'}\n                {this.state.error.stack}\n              </pre>\n            </details>\n          )}\n          <button \n            onClick={() => window.location.reload()}\n            style={{\n              padding: '12px 24px',\n              backgroundColor: '#3498db',\n              color: 'white',\n              border: 'none',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              fontSize: '16px',\n              fontWeight: '500'\n            }}\n          >\n            Reload Page\n          </button>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n\nexport default ErrorBoundary;","// Network status component\nimport React from 'react';\n\nconst NetworkStatus: React.FC = () => {\n  return null; // Placeholder for now\n};\n\nexport default NetworkStatus;","// Loading spinner component\nimport React from 'react';\n\ninterface LoadingSpinnerProps {\n  size?: 'sm' | 'md' | 'lg';\n  message?: string;\n  className?: string;\n}\n\nconst LoadingSpinner: React.FC<LoadingSpinnerProps> = ({ \n  size = 'md', \n  message = 'Loading...', \n  className = '' \n}) => {\n  return (\n    <div className={`loading-spinner ${size} ${className}`}>\n      <div className=\"spinner\"></div>\n      {message && <p className=\"loading-message\">{message}</p>}\n    </div>\n  );\n};\n\nexport default LoadingSpinner;","// Global loading manager component\nimport React, { ReactNode } from 'react';\n\ninterface GlobalLoadingManagerProps {\n  children: ReactNode;\n}\n\nexport const GlobalLoadingManager: React.FC<GlobalLoadingManagerProps> = ({ children }) => {\n  return <>{children}</>;\n};","// Icon component for consistent iconography across TravelSphere\nimport React from 'react';\n\nexport type IconName = \n  // Destinations\n  | 'destination' | 'mountain' | 'beach' | 'city' | 'forest' | 'desert'\n  // Food & Dining\n  | 'food' | 'restaurant' | 'coffee' | 'wine' | 'local-food'\n  // Safety & Emergency\n  | 'emergency' | 'medical' | 'passport' | 'hotel' | 'help' | 'phone'\n  // Chat & Communication\n  | 'chat' | 'message' | 'send' | 'assistant' | 'question'\n  // Travel & Transportation\n  | 'plane' | 'car' | 'train' | 'bus' | 'walk' | 'map'\n  // Activities & Interests\n  | 'adventure' | 'culture' | 'nature' | 'shopping' | 'camera' | 'star'\n  // UI Elements\n  | 'close' | 'menu' | 'search' | 'calendar' | 'location' | 'heart'\n  | 'check' | 'warning' | 'error' | 'info' | 'loading' | 'arrow-right'\n  | 'arrow-left' | 'arrow-up' | 'arrow-down' | 'plus' | 'minus'\n  // VR & Technology\n  | 'vr' | 'preview' | 'fullscreen' | 'play';\n\ninterface IconProps {\n  name: IconName;\n  size?: 'xs' | 'sm' | 'md' | 'lg' | 'xl' | '2xl';\n  className?: string;\n  color?: string;\n  'aria-label'?: string;\n}\n\n// Icon mapping with Unicode emojis and symbols for travel theme\nconst iconMap: Record<IconName, string> = {\n  // Destinations\n  destination: 'üèùÔ∏è',\n  mountain: 'üèîÔ∏è',\n  beach: 'üèñÔ∏è',\n  city: 'üèôÔ∏è',\n  forest: 'üå≤',\n  desert: 'üèúÔ∏è',\n  \n  // Food & Dining\n  food: 'üçΩÔ∏è',\n  restaurant: 'üç¥',\n  coffee: '‚òï',\n  wine: 'üç∑',\n  'local-food': 'ü•ò',\n  \n  // Safety & Emergency\n  emergency: 'üö®',\n  medical: 'üè•',\n  passport: 'üìò',\n  hotel: 'üè®',\n  help: 'üÜò',\n  phone: 'üìû',\n  \n  // Chat & Communication\n  chat: 'üí¨',\n  message: 'üí≠',\n  send: 'üì§',\n  assistant: 'ü§ñ',\n  question: '‚ùì',\n  \n  // Travel & Transportation\n  plane: '‚úàÔ∏è',\n  car: 'üöó',\n  train: 'üöÜ',\n  bus: 'üöå',\n  walk: 'üö∂',\n  map: 'üó∫Ô∏è',\n  \n  // Activities & Interests\n  adventure: 'üéí',\n  culture: 'üèõÔ∏è',\n  nature: 'üåø',\n  shopping: 'üõçÔ∏è',\n  camera: 'üì∏',\n  star: '‚≠ê',\n  \n  // UI Elements\n  close: '‚úï',\n  menu: '‚ò∞',\n  search: 'üîç',\n  calendar: 'üìÖ',\n  location: 'üìç',\n  heart: '‚ù§Ô∏è',\n  check: '‚úì',\n  warning: '‚ö†Ô∏è',\n  error: '‚ùå',\n  info: '‚ÑπÔ∏è',\n  loading: '‚è≥',\n  'arrow-right': '‚Üí',\n  'arrow-left': '‚Üê',\n  'arrow-up': '‚Üë',\n  'arrow-down': '‚Üì',\n  plus: '+',\n  minus: '‚àí',\n  \n  // VR & Technology\n  vr: 'ü•Ω',\n  preview: 'üëÅÔ∏è',\n  fullscreen: '‚õ∂',\n  play: '‚ñ∂Ô∏è',\n};\n\n// Size mapping for consistent sizing\nconst sizeMap = {\n  xs: '0.75rem',    // 12px\n  sm: '1rem',       // 16px\n  md: '1.25rem',    // 20px\n  lg: '1.5rem',     // 24px\n  xl: '2rem',       // 32px\n  '2xl': '2.5rem',  // 40px\n};\n\nconst Icon: React.FC<IconProps> = ({ \n  name, \n  size = 'md', \n  className = '', \n  color,\n  'aria-label': ariaLabel \n}) => {\n  const iconSymbol = iconMap[name] || '‚ùì';\n  const iconSize = sizeMap[size];\n  \n  const style: React.CSSProperties = {\n    fontSize: iconSize,\n    lineHeight: 1,\n    display: 'inline-block',\n    verticalAlign: 'middle',\n    ...(color && { color })\n  };\n\n  return (\n    <span \n      className={`icon icon-${name} icon-${size} ${className}`}\n      style={style}\n      role=\"img\"\n      aria-label={ariaLabel || name}\n    >\n      {iconSymbol}\n    </span>\n  );\n};\n\nexport default Icon;","// Enhanced Button component with icon support\nimport React from 'react';\nimport Icon, { IconName } from './Icon';\n\ninterface ButtonProps {\n  children: React.ReactNode;\n  onClick?: () => void;\n  type?: 'button' | 'submit' | 'reset';\n  variant?: 'primary' | 'secondary' | 'accent' | 'outline' | 'emergency';\n  size?: 'sm' | 'md' | 'lg';\n  disabled?: boolean;\n  loading?: boolean;\n  icon?: IconName;\n  iconPosition?: 'left' | 'right';\n  className?: string;\n  fullWidth?: boolean;\n}\n\nconst Button: React.FC<ButtonProps> = ({\n  children,\n  onClick,\n  type = 'button',\n  variant = 'primary',\n  size = 'md',\n  disabled = false,\n  loading = false,\n  icon,\n  iconPosition = 'left',\n  className = '',\n  fullWidth = false,\n}) => {\n  const sizeClasses = {\n    sm: 'btn-sm',\n    md: 'btn-md', \n    lg: 'btn-lg'\n  };\n\n  const buttonClasses = [\n    'btn',\n    variant,\n    sizeClasses[size],\n    fullWidth ? 'btn-full-width' : '',\n    loading ? 'btn-loading' : '',\n    className\n  ].filter(Boolean).join(' ');\n\n  const iconSize = size === 'sm' ? 'sm' : size === 'lg' ? 'lg' : 'md';\n\n  return (\n    <button\n      type={type}\n      onClick={onClick}\n      disabled={disabled || loading}\n      className={buttonClasses}\n    >\n      {loading ? (\n        <>\n          <Icon name=\"loading\" size={iconSize} className=\"btn-loading-icon\" />\n          <span>Loading...</span>\n        </>\n      ) : (\n        <>\n          {icon && iconPosition === 'left' && (\n            <Icon name={icon} size={iconSize} className=\"btn-icon btn-icon-left\" />\n          )}\n          <span className=\"btn-text\">{children}</span>\n          {icon && iconPosition === 'right' && (\n            <Icon name={icon} size={iconSize} className=\"btn-icon btn-icon-right\" />\n          )}\n        </>\n      )}\n    </button>\n  );\n};\n\nexport default Button;","// Performance monitoring hook\nexport const usePerformanceMonitor = (componentName: string) => {\n  const logCustomMetric = (metricName: string, value: number) => {\n    console.log(`[Performance] ${componentName}.${metricName}:`, value);\n  };\n\n  return { logCustomMetric };\n};\n\n// Hook for measuring async operations\nexport function useAsyncPerformance() {\n  const measureAsync = async <T>(\n    operation: () => Promise<T>,\n    operationName: string\n  ): Promise<T> => {\n    const startTime = performance.now();\n    \n    try {\n      const result = await operation();\n      const duration = performance.now() - startTime;\n      console.log(`[Performance] ${operationName}: ${duration.toFixed(2)}ms`);\n      return result;\n    } catch (error) {\n      const duration = performance.now() - startTime;\n      console.error(`[Performance] ${operationName} failed after ${duration.toFixed(2)}ms`);\n      throw error;\n    }\n  };\n\n  return { measureAsync };\n}","// Enhanced lazy loading image component with performance optimizations\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\nimport { usePerformanceMonitor } from '@/hooks/usePerformance';\n\ninterface LazyImageProps {\n  src: string;\n  alt: string;\n  placeholder?: string;\n  className?: string;\n  onLoad?: () => void;\n  onError?: () => void;\n  priority?: boolean; // For above-the-fold images\n  sizes?: string; // Responsive image sizes\n  srcSet?: string; // Responsive image sources\n  blurDataURL?: string; // Base64 blur placeholder\n  quality?: number; // Image quality (1-100)\n}\n\nconst LazyImage: React.FC<LazyImageProps> = ({\n  src,\n  alt,\n  placeholder = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAwIiBoZWlnaHQ9IjMwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjZjBmMGYwIi8+PHRleHQgeD0iNTAlIiB5PSI1MCUiIGZvbnQtZmFtaWx5PSJBcmlhbCwgc2Fucy1zZXJpZiIgZm9udC1zaXplPSIxOCIgZmlsbD0iIzk5OTk5OSIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iPkxvYWRpbmcuLi48L3RleHQ+PC9zdmc+',\n  className = '',\n  onLoad,\n  onError,\n  priority = false,\n  sizes,\n  srcSet,\n  blurDataURL,\n  quality = 75,\n}) => {\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [hasError, setHasError] = useState(false);\n  const [isInView, setIsInView] = useState(priority); // Load immediately if priority\n  const [loadStartTime, setLoadStartTime] = useState<number>(0);\n  const imgRef = useRef<HTMLDivElement>(null);\n  const { logCustomMetric } = usePerformanceMonitor('LazyImage');\n\n  // Preload critical images\n  useEffect(() => {\n    if (priority) {\n      const link = document.createElement('link');\n      link.rel = 'preload';\n      link.as = 'image';\n      link.href = src;\n      if (srcSet) link.setAttribute('imagesrcset', srcSet);\n      if (sizes) link.setAttribute('imagesizes', sizes);\n      document.head.appendChild(link);\n      \n      return () => {\n        if (document.head.contains(link)) {\n          document.head.removeChild(link);\n        }\n      };\n    }\n  }, [src, srcSet, sizes, priority]);\n\n  // Intersection Observer for lazy loading\n  useEffect(() => {\n    if (priority || isInView) return;\n\n    const observer = new IntersectionObserver(\n      ([entry]) => {\n        if (entry.isIntersecting) {\n          setIsInView(true);\n          setLoadStartTime(performance.now());\n          observer.disconnect();\n        }\n      },\n      {\n        threshold: 0.1,\n        rootMargin: '100px', // Start loading 100px before entering viewport\n      }\n    );\n\n    if (imgRef.current) {\n      observer.observe(imgRef.current);\n    }\n\n    return () => observer.disconnect();\n  }, [priority, isInView]);\n\n  const handleLoad = useCallback(() => {\n    setIsLoaded(true);\n    \n    // Performance monitoring\n    if (loadStartTime > 0) {\n      const loadTime = performance.now() - loadStartTime;\n      logCustomMetric('imageLoadTime', loadTime);\n    }\n    \n    onLoad?.();\n  }, [loadStartTime, logCustomMetric, onLoad]);\n\n  const handleError = useCallback(() => {\n    setHasError(true);\n    logCustomMetric('imageLoadError', 1);\n    onError?.();\n  }, [logCustomMetric, onError]);\n\n  // Generate optimized src with quality parameter\n  const getOptimizedSrc = (originalSrc: string) => {\n    if (originalSrc.includes('?')) {\n      return `${originalSrc}&q=${quality}`;\n    }\n    return `${originalSrc}?q=${quality}`;\n  };\n\n  const optimizedSrc = getOptimizedSrc(src);\n\n  return (\n    <div className={`lazy-image-container ${className}`} ref={imgRef}>\n      {/* Blur placeholder */}\n      {blurDataURL && !isLoaded && (\n        <img\n          src={blurDataURL}\n          alt=\"\"\n          className=\"lazy-image blur-placeholder\"\n          aria-hidden=\"true\"\n          style={{\n            filter: 'blur(10px)',\n            transform: 'scale(1.1)',\n          }}\n        />\n      )}\n      \n      {/* Regular placeholder */}\n      {!blurDataURL && !isInView && (\n        <div className=\"lazy-image skeleton skeleton-image\" aria-hidden=\"true\" />\n      )}\n      \n      {/* Main image */}\n      {isInView && (\n        <>\n          {!isLoaded && !blurDataURL && (\n            <div className=\"lazy-image skeleton skeleton-image\" aria-hidden=\"true\" />\n          )}\n          <img\n            src={hasError ? placeholder : optimizedSrc}\n            srcSet={hasError ? undefined : srcSet}\n            sizes={sizes}\n            alt={alt}\n            className={`lazy-image ${isLoaded ? 'loaded' : 'loading'} ${hasError ? 'error' : ''}`}\n            loading={priority ? 'eager' : 'lazy'}\n            decoding=\"async\"\n            onLoad={handleLoad}\n            onError={handleError}\n            style={{\n              opacity: isLoaded ? 1 : 0,\n              transition: 'opacity 0.3s ease',\n              willChange: isLoaded ? 'auto' : 'opacity',\n            }}\n          />\n        </>\n      )}\n      \n      {/* Loading indicator */}\n      {isInView && !isLoaded && !hasError && (\n        <div className=\"lazy-image-loading\">\n          <div className=\"loading-spinner-small\" />\n        </div>\n      )}\n      \n      {/* Error state */}\n      {hasError && (\n        <div className=\"lazy-image-error\">\n          <span>‚ö†Ô∏è</span>\n          <span>Failed to load image</span>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default LazyImage;","// API client configuration with enhanced error handling\nimport axios, { AxiosError } from 'axios';\nimport type { ApiResponse } from '@/types/api';\nimport { retryWithBackoff, createErrorResponse, isOnline } from '@/utils/errorUtils';\n\n// Create axios instance with default configuration\nexport const apiClient = axios.create({\n  baseURL: '/api',\n  timeout: 15000, // Increased timeout\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\n// Request interceptor\napiClient.interceptors.request.use(\n  (config) => {\n    // Add timestamp to prevent caching issues\n    if (config.method === 'get') {\n      config.params = { ...config.params, _t: Date.now() };\n    }\n    \n    // Add any auth tokens or common headers here\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\n// Response interceptor with enhanced error handling\napiClient.interceptors.response.use(\n  (response) => {\n    return response;\n  },\n  (error: AxiosError) => {\n    // Enhanced error logging\n    console.error('API Error Details:', {\n      url: error.config?.url,\n      method: error.config?.method,\n      status: error.response?.status,\n      message: error.message,\n      isOnline: isOnline(),\n    });\n    \n    return Promise.reject(error);\n  }\n);\n\n// Enhanced API call wrapper with retry logic\nexport async function apiCall<T>(\n  requestFn: () => Promise<T>,\n  context?: string\n): Promise<ApiResponse<T>> {\n  try {\n    const data = await retryWithBackoff(requestFn, {\n      maxAttempts: 3,\n      baseDelay: 1000,\n    });\n    \n    return {\n      success: true,\n      data,\n      timestamp: new Date(),\n    };\n  } catch (error) {\n    return createErrorResponse<T>(error, context);\n  }\n}\n\n// Generic API error handler (legacy support)\nexport const handleApiError = <T>(error: any): ApiResponse<T> => {\n  return createErrorResponse<T>(error);\n};","// Comprehensive loading state management hook\nimport { useState, useCallback, useRef } from 'react';\n\ninterface LoadingState {\n  isLoading: boolean;\n  error: string | null;\n  progress?: number;\n  stage?: string;\n}\n\ninterface LoadingStates {\n  [key: string]: LoadingState;\n}\n\nexport function useLoadingStates() {\n  const [loadingStates, setLoadingStates] = useState<LoadingStates>({});\n  const timeoutRefs = useRef<{ [key: string]: NodeJS.Timeout }>({});\n\n  const setLoading = useCallback((key: string, loading: boolean, stage?: string, progress?: number) => {\n    setLoadingStates(prev => ({\n      ...prev,\n      [key]: {\n        ...prev[key],\n        isLoading: loading,\n        stage,\n        progress,\n        error: loading ? null : prev[key]?.error || null,\n      },\n    }));\n\n    // Clear any existing timeout for this key\n    if (timeoutRefs.current[key]) {\n      clearTimeout(timeoutRefs.current[key]);\n      delete timeoutRefs.current[key];\n    }\n\n    // Set a timeout to automatically clear loading state after 30 seconds\n    if (loading) {\n      timeoutRefs.current[key] = setTimeout(() => {\n        setLoadingStates(prev => ({\n          ...prev,\n          [key]: {\n            ...prev[key],\n            isLoading: false,\n            error: 'Operation timed out. Please try again.',\n          },\n        }));\n        delete timeoutRefs.current[key];\n      }, 30000);\n    }\n  }, []);\n\n  const setError = useCallback((key: string, error: string | null) => {\n    setLoadingStates(prev => ({\n      ...prev,\n      [key]: {\n        ...prev[key],\n        isLoading: false,\n        error,\n      },\n    }));\n\n    // Clear timeout if error is set\n    if (timeoutRefs.current[key]) {\n      clearTimeout(timeoutRefs.current[key]);\n      delete timeoutRefs.current[key];\n    }\n  }, []);\n\n  const clearState = useCallback((key: string) => {\n    setLoadingStates(prev => {\n      const newState = { ...prev };\n      delete newState[key];\n      return newState;\n    });\n\n    // Clear timeout\n    if (timeoutRefs.current[key]) {\n      clearTimeout(timeoutRefs.current[key]);\n      delete timeoutRefs.current[key];\n    }\n  }, []);\n\n  const getState = useCallback((key: string): LoadingState => {\n    return loadingStates[key] || {\n      isLoading: false,\n      error: null,\n    };\n  }, [loadingStates]);\n\n  const isAnyLoading = useCallback(() => {\n    return Object.values(loadingStates).some(state => state.isLoading);\n  }, [loadingStates]);\n\n  // Cleanup timeouts on unmount\n  const cleanup = useCallback(() => {\n    Object.values(timeoutRefs.current).forEach(timeout => {\n      clearTimeout(timeout);\n    });\n    timeoutRefs.current = {};\n  }, []);\n\n  return {\n    setLoading,\n    setError,\n    clearState,\n    getState,\n    isAnyLoading,\n    cleanup,\n    loadingStates,\n  };\n}\n\n// Hook for managing a single loading operation with stages\nexport function useStageLoading(stages: string[]) {\n  const [currentStage, setCurrentStage] = useState(0);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  const startLoading = useCallback(() => {\n    setIsLoading(true);\n    setCurrentStage(0);\n    setError(null);\n  }, []);\n\n  const nextStage = useCallback(() => {\n    setCurrentStage(prev => Math.min(prev + 1, stages.length - 1));\n  }, [stages.length]);\n\n  const finishLoading = useCallback(() => {\n    setIsLoading(false);\n    setCurrentStage(0);\n  }, []);\n\n  const setLoadingError = useCallback((errorMessage: string | null) => {\n    setError(errorMessage);\n    setIsLoading(false);\n  }, []);\n\n  const progress = stages.length > 0 ? ((currentStage + 1) / stages.length) * 100 : 0;\n  const currentStageName = stages[currentStage] || '';\n\n  return {\n    isLoading,\n    error,\n    progress,\n    currentStage: currentStageName,\n    startLoading,\n    nextStage,\n    finishLoading,\n    setError: setLoadingError,\n  };\n}","/**\n * API Client Configuration\n * \n * Axios client configured for confidence engine API communication.\n */\n\nimport axios, { AxiosInstance, AxiosError, InternalAxiosRequestConfig, AxiosResponse } from 'axios';\n\n// API base URL - can be configured via environment variables\nconst API_BASE_URL = ((import.meta as any).env?.VITE_CONFIDENCE_API_BASE_URL as string | undefined) || '/api';\n\n// Create axios instance with default configuration\nexport const confidenceApiClient: AxiosInstance = axios.create({\n  baseURL: API_BASE_URL,\n  timeout: 10000, // 10 second timeout\n  headers: {\n    'Content-Type': 'application/json',\n  },\n});\n\n// Request interceptor for adding authentication tokens\nconfidenceApiClient.interceptors.request.use(\n  (config: InternalAxiosRequestConfig) => {\n    // Add auth token if available\n    const token = localStorage.getItem('authToken');\n    if (token && config.headers) {\n      config.headers.Authorization = `Bearer ${token}`;\n    }\n    \n    // Add correlation ID for request tracing\n    const correlationId = `req-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;\n    if (config.headers) {\n      config.headers['X-Correlation-ID'] = correlationId;\n    }\n    \n    return config;\n  },\n  (error: AxiosError) => {\n    return Promise.reject(error);\n  }\n);\n\n// Response interceptor for error handling\nconfidenceApiClient.interceptors.response.use(\n  (response: AxiosResponse) => {\n    return response;\n  },\n  (error: AxiosError) => {\n    // Handle specific error cases\n    if (error.response) {\n      // Server responded with error status\n      const status = error.response.status;\n      \n      switch (status) {\n        case 401:\n          // Unauthorized - clear token and redirect to login\n          localStorage.removeItem('authToken');\n          console.error('Authentication failed');\n          break;\n        case 403:\n          console.error('Access forbidden');\n          break;\n        case 404:\n          console.error('Resource not found');\n          break;\n        case 429:\n          console.error('Rate limit exceeded');\n          break;\n        case 500:\n        case 502:\n        case 503:\n        case 504:\n          console.error('Server error - service may be unavailable');\n          break;\n        default:\n          console.error(`API error: ${status}`);\n      }\n    } else if (error.request) {\n      // Request made but no response received\n      console.error('Network error - no response from server');\n    } else {\n      // Error in request configuration\n      console.error('Request configuration error:', error.message);\n    }\n    \n    return Promise.reject(error);\n  }\n);\n\n/**\n * Error response format for graceful degradation\n */\nexport interface ErrorResponse {\n  error: {\n    code: string;\n    message: string;\n    details?: any;\n    fallbackUsed: boolean;\n    retryable: boolean;\n  };\n  fallbackData?: any;\n}\n\n/**\n * Check if error is retryable\n */\nexport const isRetryableError = (error: AxiosError): boolean => {\n  if (!error.response) {\n    // Network errors are retryable\n    return true;\n  }\n  \n  const status = error.response.status;\n  // Retry on server errors and rate limiting\n  return status >= 500 || status === 429;\n};\n\n/**\n * Create error response for graceful degradation\n */\nexport const createErrorResponse = (\n  error: AxiosError,\n  fallbackData?: any\n): ErrorResponse => {\n  const status = error.response?.status;\n  \n  return {\n    error: {\n      code: error.code || `HTTP_${status}`,\n      message: error.message || 'An error occurred',\n      details: error.response?.data,\n      fallbackUsed: !!fallbackData,\n      retryable: isRetryableError(error),\n    },\n    fallbackData,\n  };\n};\n\nexport default confidenceApiClient;\n","/**\n * Confidence Score Calculation Service\n * \n * Core service for calculating traveler confidence scores based on\n * eight weighted factors. Implements the confidence score algorithm\n * with configurable weights, factor normalization, badge mapping,\n * and explanation generation.\n * \n * Algorithm:\n * ConfidenceScore = Œ£(FactorScore_i √ó Weight_i) for i = 1 to 8\n */\n\nimport type {\n  ConfidenceScoreRequest,\n  ConfidenceScoreResponse,\n  FactorBreakdown,\n  ConfidenceBadge,\n} from '../types/confidence';\n\n/**\n * Default weights for the eight confidence factors\n * These can be overridden by user-specific preference weights\n */\nexport const DEFAULT_WEIGHTS = {\n  safetyIndex: 0.20,\n  weatherStability: 0.10,\n  transportAccessibility: 0.15,\n  languageCompatibility: 0.10,\n  healthEmergency: 0.15,\n  budgetMatch: 0.10,\n  crowdDensity: 0.10,\n  preferenceAlignment: 0.10,\n};\n\n/**\n * Factor scores input for calculation\n * All scores should be normalized to 0-100 scale\n */\nexport interface FactorScores {\n  safetyIndex: number;\n  weatherStability: number;\n  transportAccessibility: number;\n  languageCompatibility: number;\n  healthEmergency: number;\n  budgetMatch: number;\n  crowdDensity: number;\n  preferenceAlignment: number;\n}\n\n/**\n * Normalizes a raw value to 0-100 scale\n * @param value - Raw value to normalize\n * @param min - Minimum possible value\n * @param max - Maximum possible value\n * @returns Normalized score between 0 and 100\n */\nexport function normalizeToScale(value: number, min: number, max: number): number {\n  if (max === min) return 50; // Default to middle if no range\n  const normalized = ((value - min) / (max - min)) * 100;\n  return Math.max(0, Math.min(100, normalized));\n}\n\n/**\n * Maps a confidence score to its badge category\n * - Low: 0-40\n * - Moderate: 41-65\n * - High: 66-85\n * - Excellent: 86-100\n */\nexport function mapScoreToBadge(score: number): ConfidenceBadge {\n  if (score <= 40) return 'Low';\n  if (score <= 65) return 'Moderate';\n  if (score <= 85) return 'High';\n  return 'Excellent';\n}\n\n/**\n * Generates a human-readable explanation for a confidence score\n */\nexport function generateScoreExplanation(\n  _score: number,\n  badge: ConfidenceBadge,\n  breakdown: FactorBreakdown[]\n): string {\n  const topFactors = breakdown\n    .sort((a, b) => b.contribution - a.contribution)\n    .slice(0, 3)\n    .map(f => f.factorName);\n\n  const badgeDescriptions = {\n    Low: 'This destination has some concerns that may affect your travel experience.',\n    Moderate: 'This destination is suitable for travel with some considerations.',\n    High: 'This destination is well-suited for your travel preferences.',\n    Excellent: 'This destination is an excellent match for your travel profile.',\n  };\n\n  const topFactorsText = topFactors.length > 0\n    ? ` Key factors include ${topFactors.join(', ')}.`\n    : '';\n\n  return `${badgeDescriptions[badge]}${topFactorsText}`;\n}\n\n/**\n * Calculates the confidence score using the weighted factor algorithm\n */\nexport function calculateConfidenceScore(\n  factorScores: FactorScores,\n  weights?: Partial<typeof DEFAULT_WEIGHTS>\n): number {\n  const finalWeights = { ...DEFAULT_WEIGHTS, ...weights };\n\n  const score =\n    factorScores.safetyIndex * finalWeights.safetyIndex +\n    factorScores.weatherStability * finalWeights.weatherStability +\n    factorScores.transportAccessibility * finalWeights.transportAccessibility +\n    factorScores.languageCompatibility * finalWeights.languageCompatibility +\n    factorScores.healthEmergency * finalWeights.healthEmergency +\n    factorScores.budgetMatch * finalWeights.budgetMatch +\n    factorScores.crowdDensity * finalWeights.crowdDensity +\n    factorScores.preferenceAlignment * finalWeights.preferenceAlignment;\n\n  // Ensure score is within 0-100 range\n  return Math.max(0, Math.min(100, score));\n}\n\n/**\n * Creates factor breakdown with explanations\n */\nexport function createFactorBreakdown(\n  factorScores: FactorScores,\n  weights: typeof DEFAULT_WEIGHTS\n): FactorBreakdown[] {\n  const factorExplanations: Record<keyof FactorScores, string> = {\n    safetyIndex: 'Based on crime data and travel advisories',\n    weatherStability: 'Forecast reliability and severe weather risk',\n    transportAccessibility: 'Public transport and infrastructure quality',\n    languageCompatibility: 'Language match and English prevalence',\n    healthEmergency: 'Hospital quality and emergency response',\n    budgetMatch: 'Cost alignment with your budget preferences',\n    crowdDensity: 'Seasonal tourism volume and crowd levels',\n    preferenceAlignment: 'Match with your travel history and preferences',\n  };\n\n  const factorNames: Record<keyof FactorScores, string> = {\n    safetyIndex: 'Safety Index',\n    weatherStability: 'Weather Stability',\n    transportAccessibility: 'Transport Accessibility',\n    languageCompatibility: 'Language Compatibility',\n    healthEmergency: 'Health & Emergency',\n    budgetMatch: 'Budget Match',\n    crowdDensity: 'Crowd Density',\n    preferenceAlignment: 'Preference Alignment',\n  };\n\n  return Object.entries(factorScores).map(([key, score]) => {\n    const factorKey = key as keyof FactorScores;\n    const weight = weights[factorKey];\n    return {\n      factorName: factorNames[factorKey],\n      score,\n      weight,\n      contribution: score * weight,\n      explanation: factorExplanations[factorKey],\n    };\n  });\n}\n\n/**\n * Main service function to calculate complete confidence score response\n */\nexport function calculateConfidenceScoreResponse(\n  request: ConfidenceScoreRequest,\n  factorScores: FactorScores\n): ConfidenceScoreResponse {\n  // Use user-specific weights if available, otherwise use defaults\n  const weights = request.userProfile?.preferenceWeights?.weights\n    ? {\n        safetyIndex: request.userProfile.preferenceWeights.weights.safetyIndex,\n        weatherStability: request.userProfile.preferenceWeights.weights.weatherStability,\n        transportAccessibility: request.userProfile.preferenceWeights.weights.transportAccessibility,\n        languageCompatibility: request.userProfile.preferenceWeights.weights.languageCompatibility,\n        healthEmergency: request.userProfile.preferenceWeights.weights.healthEmergency,\n        budgetMatch: request.userProfile.preferenceWeights.weights.budgetMatch,\n        crowdDensity: request.userProfile.preferenceWeights.weights.crowdDensity,\n        preferenceAlignment: DEFAULT_WEIGHTS.preferenceAlignment, // Not in PreferenceWeights\n      }\n    : DEFAULT_WEIGHTS;\n\n  const score = calculateConfidenceScore(factorScores, weights);\n  const badge = mapScoreToBadge(score);\n  const breakdown = createFactorBreakdown(factorScores, weights);\n  const explanation = generateScoreExplanation(score, badge, breakdown);\n\n  return {\n    destinationId: request.destinationId,\n    score,\n    badge,\n    breakdown,\n    explanation,\n    calculatedAt: new Date().toISOString(),\n    ttl: 21600, // 6 hours in seconds\n  };\n}\n","/**\n * Mock Confidence Service\n * \n * Frontend-only implementation using mock data for demonstration.\n * This can be replaced with real API calls later.\n */\n\nimport type { ConfidenceScoreResponse } from '../types/confidence';\nimport { calculateConfidenceScore, mapScoreToBadge, createFactorBreakdown, generateScoreExplanation, DEFAULT_WEIGHTS, type FactorScores } from './confidenceScoreService';\n\n// Mock confidence scores for known destinations\nconst DESTINATION_CONFIDENCE_DATA: Record<string, FactorScores> = {\n  'bengaluru': {\n    safetyIndex: 80,\n    weatherStability: 85,\n    transportAccessibility: 75,\n    languageCompatibility: 90,\n    healthEmergency: 85,\n    budgetMatch: 85,\n    crowdDensity: 55,\n    preferenceAlignment: 80,\n  },\n  'tokyo': {\n    safetyIndex: 95,\n    weatherStability: 80,\n    transportAccessibility: 98,\n    languageCompatibility: 50,\n    healthEmergency: 92,\n    budgetMatch: 60,\n    crowdDensity: 40,\n    preferenceAlignment: 85,\n  },\n  'bali': {\n    safetyIndex: 75,\n    weatherStability: 85,\n    transportAccessibility: 65,\n    languageCompatibility: 55,\n    healthEmergency: 70,\n    budgetMatch: 90,\n    crowdDensity: 60,\n    preferenceAlignment: 80,\n  },\n  'new-york': {\n    safetyIndex: 80,\n    weatherStability: 70,\n    transportAccessibility: 90,\n    languageCompatibility: 95,\n    healthEmergency: 95,\n    budgetMatch: 40,\n    crowdDensity: 35,\n    preferenceAlignment: 75,\n  },\n  'santorini': {\n    safetyIndex: 90,\n    weatherStability: 90,\n    transportAccessibility: 60,\n    languageCompatibility: 65,\n    healthEmergency: 75,\n    budgetMatch: 55,\n    crowdDensity: 50,\n    preferenceAlignment: 85,\n  },\n  'iceland': {\n    safetyIndex: 98,\n    weatherStability: 60,\n    transportAccessibility: 70,\n    languageCompatibility: 85,\n    healthEmergency: 88,\n    budgetMatch: 45,\n    crowdDensity: 70,\n    preferenceAlignment: 75,\n  },\n};\n\n/**\n * Calculate confidence score for a destination (mock implementation)\n */\nexport async function getMockConfidenceScore(\n  destinationId: string,\n  _userId?: string\n): Promise<ConfidenceScoreResponse> {\n  // Simulate API delay\n  await new Promise(resolve => setTimeout(resolve, 300));\n  \n  // Get destination-specific scores or generate random ones\n  const factorScores = DESTINATION_CONFIDENCE_DATA[destinationId] || generateRandomFactorScores();\n  \n  // Calculate score using the real algorithm\n  const score = calculateConfidenceScore(factorScores, DEFAULT_WEIGHTS);\n  const badge = mapScoreToBadge(score);\n  const breakdown = createFactorBreakdown(factorScores, DEFAULT_WEIGHTS);\n  const explanation = generateScoreExplanation(score, badge, breakdown);\n  \n  return {\n    destinationId,\n    score,\n    badge,\n    breakdown,\n    explanation,\n    calculatedAt: new Date().toISOString(),\n    ttl: 21600,\n  };\n}\n\n/**\n * Generate random factor scores for unknown destinations\n */\nfunction generateRandomFactorScores(): FactorScores {\n  return {\n    safetyIndex: 60 + Math.random() * 35,\n    weatherStability: 60 + Math.random() * 35,\n    transportAccessibility: 60 + Math.random() * 35,\n    languageCompatibility: 50 + Math.random() * 40,\n    healthEmergency: 65 + Math.random() * 30,\n    budgetMatch: 50 + Math.random() * 40,\n    crowdDensity: 40 + Math.random() * 50,\n    preferenceAlignment: 60 + Math.random() * 35,\n  };\n}\n\n/**\n * Get all confidence scores for multiple destinations\n */\nexport async function getMockConfidenceScores(\n  destinationIds: string[]\n): Promise<Record<string, ConfidenceScoreResponse>> {\n  const scores: Record<string, ConfidenceScoreResponse> = {};\n  \n  for (const id of destinationIds) {\n    scores[id] = await getMockConfidenceScore(id);\n  }\n  \n  return scores;\n}\n","import React from 'react';\nimport type { ConfidenceBadge as BadgeType } from '../types/confidence';\nimport './ConfidenceBadge.css';\n\ninterface ConfidenceBadgeProps {\n  score: number;\n  badge: BadgeType;\n  size?: 'sm' | 'md' | 'lg';\n  showMeter?: boolean;\n  onClick?: () => void;\n  className?: string;\n}\n\nexport const ConfidenceBadge: React.FC<ConfidenceBadgeProps> = ({\n  score,\n  badge,\n  size = 'md',\n  showMeter = true,\n  onClick,\n  className = '',\n}) => {\n  const badgeColors = {\n    Low: '#ef4444',\n    Moderate: '#f59e0b',\n    High: '#10b981',\n    Excellent: '#3b82f6',\n  };\n  \n  const color = badgeColors[badge];\n  \n  return (\n    <div \n      className={`confidence-badge confidence-badge-${size} ${className}`}\n      onClick={onClick}\n      role={onClick ? 'button' : undefined}\n      tabIndex={onClick ? 0 : undefined}\n      onKeyPress={(e) => {\n        if (onClick && (e.key === 'Enter' || e.key === ' ')) {\n          onClick();\n        }\n      }}\n      aria-label={`Confidence score: ${score} out of 100, ${badge}`}\n    >\n      <div className=\"badge-header\">\n        <span \n          className=\"badge-label\"\n          style={{ backgroundColor: color }}\n        >\n          {badge}\n        </span>\n        <span className=\"badge-score\">{Math.round(score)}</span>\n      </div>\n      \n      {showMeter && (\n        <div className=\"confidence-meter\">\n          <div \n            className=\"meter-fill\"\n            style={{ \n              width: `${score}%`,\n              backgroundColor: color,\n            }}\n            aria-valuenow={score}\n            aria-valuemin={0}\n            aria-valuemax={100}\n            role=\"progressbar\"\n          />\n        </div>\n      )}\n    </div>\n  );\n};\n","import React, { useEffect } from 'react';\nimport type { ConfidenceScoreResponse } from '../types/confidence';\nimport './ConfidenceBreakdownModal.css';\n\ninterface ConfidenceBreakdownModalProps {\n  score: ConfidenceScoreResponse;\n  onClose: () => void;\n}\n\nexport const ConfidenceBreakdownModal: React.FC<ConfidenceBreakdownModalProps> = ({\n  score,\n  onClose,\n}) => {\n  // Handle escape key\n  useEffect(() => {\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        onClose();\n      }\n    };\n    \n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [onClose]);\n  \n  // Prevent body scroll when modal is open\n  useEffect(() => {\n    document.body.style.overflow = 'hidden';\n    return () => {\n      document.body.style.overflow = 'unset';\n    };\n  }, []);\n  \n  const badgeColors = {\n    Low: '#ef4444',\n    Moderate: '#f59e0b',\n    High: '#10b981',\n    Excellent: '#3b82f6',\n  };\n  \n  return (\n    <div className=\"modal-overlay\" onClick={onClose}>\n      <div \n        className=\"modal-content confidence-modal\"\n        onClick={(e) => e.stopPropagation()}\n        role=\"dialog\"\n        aria-labelledby=\"modal-title\"\n        aria-modal=\"true\"\n      >\n        <div className=\"modal-header\">\n          <h2 id=\"modal-title\">Confidence Score Breakdown</h2>\n          <button \n            className=\"close-button\"\n            onClick={onClose}\n            aria-label=\"Close modal\"\n          >\n            √ó\n          </button>\n        </div>\n        \n        <div className=\"modal-body\">\n          {/* Overall Score */}\n          <div className=\"overall-score\">\n            <div \n              className=\"score-circle\"\n              style={{ borderColor: badgeColors[score.badge] }}\n            >\n              <span className=\"score-value\">{Math.round(score.score)}</span>\n              <span \n                className=\"score-label\"\n                style={{ color: badgeColors[score.badge] }}\n              >\n                {score.badge}\n              </span>\n            </div>\n            <p className=\"score-explanation\">{score.explanation}</p>\n          </div>\n          \n          {/* Factor Breakdown Table */}\n          <div className=\"factor-breakdown\">\n            <h3>Factor Analysis</h3>\n            <div className=\"breakdown-table-container\">\n              <table className=\"breakdown-table\">\n                <thead>\n                  <tr>\n                    <th>Factor</th>\n                    <th>Score</th>\n                    <th>Weight</th>\n                    <th>Impact</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {score.breakdown.map((factor, index) => (\n                    <tr key={index}>\n                      <td>\n                        <div className=\"factor-cell\">\n                          <div className=\"factor-name\">{factor.factorName}</div>\n                          <div className=\"factor-explanation\">{factor.explanation}</div>\n                        </div>\n                      </td>\n                      <td>\n                        <div className=\"factor-score\">\n                          <div className=\"score-bar-container\">\n                            <div \n                              className=\"score-bar\"\n                              style={{ \n                                width: `${factor.score}%`,\n                                backgroundColor: factor.score >= 70 ? '#10b981' : factor.score >= 50 ? '#f59e0b' : '#ef4444'\n                              }}\n                            />\n                          </div>\n                          <span className=\"score-number\">{Math.round(factor.score)}</span>\n                        </div>\n                      </td>\n                      <td>\n                        <div className=\"factor-weight\">\n                          {(factor.weight * 100).toFixed(0)}%\n                        </div>\n                      </td>\n                      <td>\n                        <div className=\"factor-contribution\">\n                          {factor.contribution.toFixed(1)}\n                        </div>\n                      </td>\n                    </tr>\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n          \n          {/* Info Footer */}\n          <div className=\"modal-footer\">\n            <p className=\"info-text\">\n              <strong>How it works:</strong> The confidence score is calculated using 8 weighted factors. \n              Each factor is scored 0-100, then multiplied by its weight to determine its impact on the overall score.\n            </p>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n","/**\n * Preference Learning Service\n * \n * Tracks user preferences and learns from behavior\n */\n\nconst PREFERENCES_KEY = 'traveler_preferences';\nconst INTERACTIONS_KEY = 'traveler_interactions';\n\nexport interface TravelerPreferences {\n  budgetRange: { min: number; max: number; currency: string };\n  travelStyle: 'budget' | 'balanced' | 'luxury' | 'adventurous' | 'relaxed';\n  interests: string[];\n  dietaryRestrictions: string[];\n  accessibilityNeeds: string[];\n  languagePreferences: string[];\n  previousDestinations: string[];\n  preferredActivities: string[];\n  avoidances: string[];\n}\n\nexport interface ImplicitSignal {\n  destinationId: string;\n  action: 'view' | 'click' | 'bookmark' | 'share';\n  duration?: number;\n  timestamp: Date;\n}\n\nexport interface ExplicitFeedback {\n  destinationId: string;\n  rating: number;\n  categories: string[];\n  comments?: string;\n  timestamp: Date;\n}\n\nexport interface PreferenceWeights {\n  budgetSensitivity: number;\n  safetyPriority: number;\n  adventureLevel: number;\n  crowdTolerance: number;\n  culturalInterest: number;\n  naturePreference: number;\n  foodImportance: number;\n  luxuryPreference: number;\n}\n\n/**\n * Get stored preferences or return defaults\n */\nexport function getPreferences(): TravelerPreferences {\n  const stored = localStorage.getItem(PREFERENCES_KEY);\n  if (stored) {\n    try {\n      return JSON.parse(stored);\n    } catch {\n      return getDefaultPreferences();\n    }\n  }\n  return getDefaultPreferences();\n}\n\n/**\n * Get default preferences\n */\nfunction getDefaultPreferences(): TravelerPreferences {\n  return {\n    budgetRange: { min: 50, max: 200, currency: 'USD' },\n    travelStyle: 'balanced',\n    interests: ['culture', 'food', 'nature'],\n    dietaryRestrictions: [],\n    accessibilityNeeds: [],\n    languagePreferences: ['en'],\n    previousDestinations: [],\n    preferredActivities: [],\n    avoidances: [],\n  };\n}\n\n/**\n * Save preferences\n */\nexport function savePreferences(preferences: TravelerPreferences): void {\n  localStorage.setItem(PREFERENCES_KEY, JSON.stringify(preferences));\n}\n\n/**\n * Track implicit signal (view, click, etc.)\n */\nexport function trackImplicitSignal(signal: ImplicitSignal): void {\n  const interactions = getInteractions();\n  interactions.push({\n    ...signal,\n    timestamp: new Date(),\n  });\n  \n  // Keep only last 100 interactions\n  if (interactions.length > 100) {\n    interactions.shift();\n  }\n  \n  localStorage.setItem(INTERACTIONS_KEY, JSON.stringify(interactions));\n  \n  // Update preferences based on signal\n  updatePreferencesFromSignal(signal);\n}\n\n/**\n * Submit explicit feedback\n */\nexport function submitFeedback(feedback: ExplicitFeedback): void {\n  const preferences = getPreferences();\n  \n  // Add to previous destinations if rated highly\n  if (feedback.rating >= 4 && !preferences.previousDestinations.includes(feedback.destinationId)) {\n    preferences.previousDestinations.push(feedback.destinationId);\n  }\n  \n  // Update interests based on categories\n  feedback.categories.forEach(category => {\n    if (!preferences.interests.includes(category)) {\n      preferences.interests.push(category);\n    }\n  });\n  \n  savePreferences(preferences);\n}\n\n/**\n * Get preference weights for confidence scoring\n */\nexport function getPreferenceWeights(): PreferenceWeights {\n  const preferences = getPreferences();\n  const interactions = getInteractions();\n  \n  // Calculate weights based on preferences and behavior\n  const weights: PreferenceWeights = {\n    budgetSensitivity: calculateBudgetSensitivity(preferences),\n    safetyPriority: calculateSafetyPriority(preferences),\n    adventureLevel: calculateAdventureLevel(preferences, interactions),\n    crowdTolerance: calculateCrowdTolerance(preferences, interactions),\n    culturalInterest: calculateCulturalInterest(preferences, interactions),\n    naturePreference: calculateNaturePreference(preferences, interactions),\n    foodImportance: calculateFoodImportance(preferences, interactions),\n    luxuryPreference: calculateLuxuryPreference(preferences),\n  };\n  \n  return weights;\n}\n\n/**\n * Get stored interactions\n */\nfunction getInteractions(): ImplicitSignal[] {\n  const stored = localStorage.getItem(INTERACTIONS_KEY);\n  if (stored) {\n    try {\n      return JSON.parse(stored);\n    } catch {\n      return [];\n    }\n  }\n  return [];\n}\n\n/**\n * Update preferences based on implicit signal\n */\nfunction updatePreferencesFromSignal(_signal: ImplicitSignal): void {\n  // For now, just track the signal\n  // In a real implementation, this would use ML to update preferences\n}\n\n/**\n * Calculate budget sensitivity (0-1)\n */\nfunction calculateBudgetSensitivity(preferences: TravelerPreferences): number {\n  const range = preferences.budgetRange.max - preferences.budgetRange.min;\n  if (range < 50) return 0.9; // Very budget conscious\n  if (range < 150) return 0.6; // Moderate\n  return 0.3; // Flexible budget\n}\n\n/**\n * Calculate safety priority (0-1)\n */\nfunction calculateSafetyPriority(preferences: TravelerPreferences): number {\n  // Higher priority for families, accessibility needs, etc.\n  if (preferences.accessibilityNeeds.length > 0) return 0.9;\n  return 0.7; // Default high priority\n}\n\n/**\n * Calculate adventure level (0-1)\n */\nfunction calculateAdventureLevel(preferences: TravelerPreferences, _interactions: ImplicitSignal[]): number {\n  const adventureInterests = ['adventure', 'hiking', 'sports', 'extreme'];\n  const hasAdventureInterest = preferences.interests.some((i: string) => adventureInterests.includes(i));\n  \n  if (hasAdventureInterest) return 0.8;\n  if (preferences.travelStyle === 'adventurous') return 0.9;\n  if (preferences.travelStyle === 'relaxed') return 0.3;\n  return 0.5;\n}\n\n/**\n * Calculate crowd tolerance (0-1)\n */\nfunction calculateCrowdTolerance(preferences: TravelerPreferences, _interactions: ImplicitSignal[]): number {\n  if (preferences.avoidances.includes('crowds')) return 0.2;\n  if (preferences.travelStyle === 'relaxed') return 0.4;\n  return 0.6;\n}\n\n/**\n * Calculate cultural interest (0-1)\n */\nfunction calculateCulturalInterest(preferences: TravelerPreferences, _interactions: ImplicitSignal[]): number {\n  const culturalInterests = ['culture', 'history', 'art', 'museums'];\n  const count = preferences.interests.filter((i: string) => culturalInterests.includes(i)).length;\n  return Math.min(count * 0.3, 1);\n}\n\n/**\n * Calculate nature preference (0-1)\n */\nfunction calculateNaturePreference(preferences: TravelerPreferences, _interactions: ImplicitSignal[]): number {\n  const natureInterests = ['nature', 'hiking', 'wildlife', 'outdoors'];\n  const count = preferences.interests.filter((i: string) => natureInterests.includes(i)).length;\n  return Math.min(count * 0.3, 1);\n}\n\n/**\n * Calculate food importance (0-1)\n */\nfunction calculateFoodImportance(preferences: TravelerPreferences, _interactions: ImplicitSignal[]): number {\n  if (preferences.interests.includes('food')) return 0.9;\n  if (preferences.dietaryRestrictions.length > 0) return 0.8;\n  return 0.6;\n}\n\n/**\n * Calculate luxury preference (0-1)\n */\nfunction calculateLuxuryPreference(preferences: TravelerPreferences): number {\n  if (preferences.travelStyle === 'luxury') return 0.9;\n  if (preferences.budgetRange.min > 150) return 0.7;\n  if (preferences.budgetRange.max < 100) return 0.2;\n  return 0.5;\n}\n\n/**\n * Clear all stored preferences and interactions\n */\nexport function clearPreferences(): void {\n  localStorage.removeItem(PREFERENCES_KEY);\n  localStorage.removeItem(INTERACTIONS_KEY);\n}\n","import React, { useState, useEffect } from 'react';\nimport type { DestinationCardProps } from '@/types/destination';\nimport { Button, Icon } from '@/components/shared';\nimport LazyImage from '@/components/shared/LazyImage';\nimport { ConfidenceBadge, ConfidenceBreakdownModal, useConfidenceScore } from '@/confidence-engine';\nimport { trackImplicitSignal } from '@/confidence-engine/services/preferenceLearningService';\nimport './DestinationCard.css';\n\nconst DestinationCard: React.FC<DestinationCardProps> = ({\n  id,\n  name,\n  description,\n  imageUrl,\n  vrPreviewUrl,\n  priority = false,\n  onPlanTrip,\n  onVRPreview,\n}) => {\n  const [showBreakdown, setShowBreakdown] = useState(false);\n  const { score, loading } = useConfidenceScore(id);\n\n  // Track view when component mounts\n  useEffect(() => {\n    const viewStartTime = Date.now();\n    \n    try {\n      trackImplicitSignal({\n        destinationId: id,\n        action: 'view',\n        timestamp: new Date(),\n      });\n    } catch (error) {\n      console.error('Error tracking view:', error);\n    }\n    \n    // Track duration when component unmounts\n    return () => {\n      try {\n        const duration = Date.now() - viewStartTime;\n        if (duration > 1000) { // Only track if viewed for more than 1 second\n          trackImplicitSignal({\n            destinationId: id,\n            action: 'view',\n            duration,\n            timestamp: new Date(),\n          });\n        }\n      } catch (error) {\n        console.error('Error tracking duration:', error);\n      }\n    };\n  }, [id]);\n\n  const handlePlanTrip = () => {\n    try {\n      trackImplicitSignal({\n        destinationId: id,\n        action: 'click',\n        timestamp: new Date(),\n      });\n    } catch (error) {\n      console.error('Error tracking click:', error);\n    }\n    onPlanTrip(id);\n  };\n\n  const handleVRPreview = () => {\n    if (vrPreviewUrl) {\n      try {\n        trackImplicitSignal({\n          destinationId: id,\n          action: 'click',\n          timestamp: new Date(),\n        });\n      } catch (error) {\n        console.error('Error tracking VR click:', error);\n      }\n      onVRPreview(vrPreviewUrl);\n    }\n  };\n\n  const handleBadgeClick = () => {\n    if (score) {\n      try {\n        trackImplicitSignal({\n          destinationId: id,\n          action: 'click',\n          timestamp: new Date(),\n        });\n      } catch (error) {\n        console.error('Error tracking badge click:', error);\n      }\n      setShowBreakdown(true);\n    }\n  };\n\n  return (\n    <article \n      className=\"destination-card card optimized-animation\"\n      role=\"article\"\n      aria-labelledby={`destination-${id}-title`}\n    >\n      <div className=\"destination-image-container\">\n        <LazyImage\n          src={imageUrl}\n          alt={`Beautiful view of ${name}`}\n          className=\"destination-image\"\n          priority={priority}\n          sizes=\"(max-width: 768px) 100vw, (max-width: 1024px) 50vw, 33vw\"\n          quality={85}\n        />\n        <div className=\"destination-overlay\" />\n        \n        {/* Confidence Badge Overlay */}\n        {!loading && score && (\n          <div className=\"confidence-badge-overlay\">\n            <ConfidenceBadge \n              score={score.score}\n              badge={score.badge}\n              onClick={handleBadgeClick}\n              size=\"sm\"\n            />\n          </div>\n        )}\n      </div>\n      \n      <div className=\"destination-content\">\n        <h3 \n          id={`destination-${id}-title`}\n          className=\"destination-title\"\n        >\n          <Icon name=\"location\" size=\"sm\" />\n          {name}\n        </h3>\n        \n        <p className=\"destination-description\">\n          {description}\n        </p>\n        \n        <div className=\"destination-actions\">\n          {vrPreviewUrl && (\n            <Button \n              variant=\"secondary\"\n              icon=\"vr\"\n              onClick={handleVRPreview}\n              className=\"vr-button\"\n            >\n              Preview in VR\n            </Button>\n          )}\n          \n          <Button \n            variant=\"primary\"\n            icon=\"plane\"\n            onClick={handlePlanTrip}\n            className=\"plan-button\"\n          >\n            Plan My Trip\n          </Button>\n        </div>\n      </div>\n      \n      {/* Confidence Breakdown Modal */}\n      {showBreakdown && score && (\n        <ConfidenceBreakdownModal \n          score={score}\n          onClose={() => setShowBreakdown(false)}\n        />\n      )}\n    </article>\n  );\n};\n\nexport default DestinationCard;","import { useState, useEffect } from 'react';\nimport type { ConfidenceScoreResponse } from '../types/confidence';\nimport { getMockConfidenceScore } from '../services/mockConfidenceService';\n\ninterface UseConfidenceScoreResult {\n  score: ConfidenceScoreResponse | null;\n  loading: boolean;\n  error: Error | null;\n  refetch: () => Promise<void>;\n}\n\n/**\n * Custom hook to fetch and manage confidence scores for destinations\n */\nexport function useConfidenceScore(\n  destinationId: string | null,\n  userId?: string\n): UseConfidenceScoreResult {\n  const [score, setScore] = useState<ConfidenceScoreResponse | null>(null);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<Error | null>(null);\n\n  const fetchScore = async () => {\n    if (!destinationId) {\n      setScore(null);\n      setLoading(false);\n      return;\n    }\n\n    setLoading(true);\n    setError(null);\n\n    try {\n      const result = await getMockConfidenceScore(destinationId, userId);\n      setScore(result);\n      setError(null);\n    } catch (err) {\n      console.error('Error fetching confidence score:', err);\n      setError(err instanceof Error ? err : new Error('Failed to fetch confidence score'));\n      setScore(null);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchScore();\n  }, [destinationId, userId]);\n\n  return {\n    score,\n    loading,\n    error,\n    refetch: fetchScore,\n  };\n}\n","import React, { useEffect, useRef, useState } from 'react';\nimport { Button, Icon, LoadingSpinner } from '@/components/shared';\nimport './VRModal.css';\n\ninterface VRModalProps {\n  vrUrl: string;\n  onClose: () => void;\n  isOpen: boolean;\n}\n\nconst VRModal: React.FC<VRModalProps> = ({ vrUrl, onClose, isOpen }) => {\n  const modalRef = useRef<HTMLDivElement>(null);\n  const iframeRef = useRef<HTMLIFrameElement>(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [hasError, setHasError] = useState(false);\n\n  // Handle escape key press\n  useEffect(() => {\n    const handleEscapeKey = (event: KeyboardEvent) => {\n      if (event.key === 'Escape') {\n        onClose();\n      }\n    };\n\n    if (isOpen) {\n      document.addEventListener('keydown', handleEscapeKey);\n      // Prevent body scroll when modal is open\n      document.body.style.overflow = 'hidden';\n    }\n\n    return () => {\n      document.removeEventListener('keydown', handleEscapeKey);\n      document.body.style.overflow = 'unset';\n    };\n  }, [isOpen, onClose]);\n\n  // Focus management for accessibility\n  useEffect(() => {\n    if (isOpen && modalRef.current) {\n      modalRef.current.focus();\n    }\n  }, [isOpen]);\n\n  // Handle iframe load events\n  const handleIframeLoad = () => {\n    setIsLoading(false);\n    setHasError(false);\n  };\n\n  const handleIframeError = () => {\n    setIsLoading(false);\n    setHasError(true);\n  };\n\n  // Handle backdrop click\n  const handleBackdropClick = (event: React.MouseEvent<HTMLDivElement>) => {\n    if (event.target === event.currentTarget) {\n      onClose();\n    }\n  };\n\n  // Reset states when modal opens\n  useEffect(() => {\n    if (isOpen) {\n      setIsLoading(true);\n      setHasError(false);\n    }\n  }, [isOpen, vrUrl]);\n\n  const handleRetry = () => {\n    setIsLoading(true);\n    setHasError(false);\n    if (iframeRef.current) {\n      iframeRef.current.src = vrUrl;\n    }\n  };\n\n  if (!isOpen) {\n    return null;\n  }\n\n  return (\n    <div\n      className=\"vr-modal-backdrop\"\n      onClick={handleBackdropClick}\n      role=\"dialog\"\n      aria-modal=\"true\"\n      aria-labelledby=\"vr-modal-title\"\n      aria-describedby=\"vr-modal-description\"\n    >\n      <div\n        ref={modalRef}\n        className=\"vr-modal-container\"\n        tabIndex={-1}\n      >\n        {/* Modal Header */}\n        <div className=\"vr-modal-header\">\n          <h2 id=\"vr-modal-title\" className=\"vr-modal-title\">\n            <Icon name=\"vr\" size=\"lg\" />\n            Virtual Reality Preview\n          </h2>\n          <p id=\"vr-modal-description\" className=\"vr-modal-description\">\n            Explore this destination in 360¬∞ virtual reality\n          </p>\n          <button\n            className=\"vr-modal-close\"\n            onClick={onClose}\n            aria-label=\"Close VR preview\"\n            type=\"button\"\n          >\n            <Icon name=\"close\" size=\"lg\" />\n          </button>\n        </div>\n\n        {/* Modal Content */}\n        <div className=\"vr-modal-content\">\n          {isLoading && (\n            <div className=\"vr-modal-loading\">\n              <LoadingSpinner \n                size=\"lg\"\n                message=\"Loading VR experience...\"\n              />\n            </div>\n          )}\n\n          {hasError && (\n            <div className=\"vr-modal-error\">\n              <div className=\"error-container\">\n                <Icon name=\"warning\" size=\"2xl\" className=\"error-icon\" />\n                <h3>VR Content Unavailable</h3>\n                <p>\n                  We're unable to load the VR preview at this time. \n                  Please try again later or contact support if the problem persists.\n                </p>\n                <div className=\"error-actions\">\n                  <Button \n                    variant=\"secondary\"\n                    icon=\"arrow-right\"\n                    onClick={handleRetry}\n                  >\n                    Try Again\n                  </Button>\n                  <Button \n                    variant=\"primary\"\n                    icon=\"close\"\n                    onClick={onClose}\n                  >\n                    Close\n                  </Button>\n                </div>\n              </div>\n            </div>\n          )}\n\n          {vrUrl && (\n            <iframe\n              ref={iframeRef}\n              src={vrUrl}\n              className={`vr-modal-iframe ${isLoading ? 'loading' : ''} ${hasError ? 'error' : ''}`}\n              title=\"Virtual Reality Preview\"\n              allowFullScreen\n              allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\"\n              onLoad={handleIframeLoad}\n              onError={handleIframeError}\n              sandbox=\"allow-scripts allow-same-origin allow-presentation\"\n            />\n          )}\n        </div>\n\n        {/* Modal Footer */}\n        <div className=\"vr-modal-footer\">\n          <div className=\"vr-modal-controls\">\n            <Button\n              variant=\"secondary\"\n              icon=\"close\"\n              onClick={onClose}\n            >\n              Close Preview\n            </Button>\n            <div className=\"vr-modal-tips\">\n              <Icon name=\"info\" size=\"sm\" className=\"tip-icon\" />\n              <span className=\"tip-text\">\n                Use your mouse or touch to look around in 360¬∞\n              </span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default VRModal;","import React, { useState } from 'react';\nimport DestinationCard from './DestinationCard';\nimport VRModal from './VRModal';\nimport type { Destination } from '@/types/destination';\nimport './DestinationGrid.css';\n\ninterface DestinationGridProps {\n  destinations: Destination[];\n  onPlanTrip: (destinationId: string) => void;\n  loading?: boolean;\n  error?: string | null;\n}\n\nconst DestinationGrid: React.FC<DestinationGridProps> = ({\n  destinations,\n  onPlanTrip,\n  loading = false,\n  error = null,\n}) => {\n  const [vrModalOpen, setVrModalOpen] = useState(false);\n  const [currentVrUrl, setCurrentVrUrl] = useState<string>('');\n\n  const handleVRPreview = (vrUrl: string) => {\n    setCurrentVrUrl(vrUrl);\n    setVrModalOpen(true);\n  };\n\n  const handleCloseVRModal = () => {\n    setVrModalOpen(false);\n    setCurrentVrUrl('');\n  };\n\n  if (loading) {\n    return (\n      <div className=\"destination-grid-loading\">\n        <div className=\"loading-spinner\">\n          <div className=\"spinner\">\n            <div className=\"spinner-ring\"></div>\n            <div className=\"spinner-icon\">üåç</div>\n          </div>\n          <p className=\"loading-message\">Discovering amazing destinations...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    return (\n      <div className=\"destination-grid-error\">\n        <div className=\"error-container\">\n          <div className=\"error-icon\">‚ö†Ô∏è</div>\n          <h3>Unable to Load Destinations</h3>\n          <p>{error}</p>\n          <button \n            className=\"btn primary\"\n            onClick={() => window.location.reload()}\n          >\n            Try Again\n          </button>\n        </div>\n      </div>\n    );\n  }\n\n  if (destinations.length === 0) {\n    return (\n      <div className=\"destination-grid-empty\">\n        <div className=\"empty-state\">\n          <div className=\"empty-icon\">üó∫Ô∏è</div>\n          <h3>No Destinations Found</h3>\n          <p>We're working on adding more amazing destinations for you to explore.</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <>\n      <div className=\"destination-grid\">\n        {destinations.map((destination, index) => (\n          <DestinationCard\n            key={destination.id}\n            id={destination.id}\n            name={destination.name}\n            description={destination.description}\n            imageUrl={destination.imageUrl}\n            vrPreviewUrl={destination.vrPreviewUrl}\n            priority={index < 3} // Prioritize first 3 cards for above-the-fold loading\n            onPlanTrip={onPlanTrip}\n            onVRPreview={handleVRPreview}\n          />\n        ))}\n      </div>\n\n      {vrModalOpen && (\n        <VRModal\n          vrUrl={currentVrUrl}\n          onClose={handleCloseVRModal}\n          isOpen={vrModalOpen}\n        />\n      )}\n    </>\n  );\n};\n\nexport default DestinationGrid;"],"names":["ErrorBoundary","Component","constructor","props","super","this","state","hasError","getDerivedStateFromError","error","componentDidCatch","errorInfo","render","jsxs","className","style","padding","textAlign","maxWidth","margin","backgroundColor","borderRadius","boxShadow","children","jsx","color","marginBottom","fontSize","cursor","fontWeight","whiteSpace","wordBreak","toString","stack","onClick","window","location","reload","border","NetworkStatus","LoadingSpinner","size","message","GlobalLoadingManager","iconMap","destination","mountain","beach","city","forest","desert","food","restaurant","coffee","wine","emergency","medical","passport","hotel","help","phone","chat","send","assistant","question","plane","car","train","bus","walk","map","adventure","culture","nature","shopping","camera","star","close","menu","search","calendar","heart","check","warning","info","loading","plus","minus","vr","preview","fullscreen","play","sizeMap","xs","sm","md","lg","xl","Icon","name","ariaLabel","iconSymbol","lineHeight","display","verticalAlign","role","Button","type","variant","disabled","icon","iconPosition","fullWidth","buttonClasses","filter","Boolean","join","iconSize","Fragment","useAsyncPerformance","measureAsync","async","operation","operationName","startTime","performance","now","result","LazyImage","src","alt","placeholder","onLoad","onError","priority","sizes","srcSet","blurDataURL","quality","isLoaded","setIsLoaded","useState","setHasError","isInView","setIsInView","loadStartTime","setLoadStartTime","imgRef","useRef","logCustomMetric","metricName","value","useEffect","link","document","createElement","rel","as","href","setAttribute","head","appendChild","contains","removeChild","observer","IntersectionObserver","entry","isIntersecting","disconnect","threshold","rootMargin","current","observe","handleLoad","useCallback","handleError","optimizedSrc","originalSrc","includes","ref","transform","decoding","opacity","transition","willChange","apiClient","axios","create","baseURL","timeout","headers","useStageLoading","stages","currentStage","setCurrentStage","isLoading","setIsLoading","setError","startLoading","nextStage","prev","Math","min","length","finishLoading","setLoadingError","errorMessage","progress","interceptors","request","use","config","method","params","_t","Date","Promise","reject","response","API_BASE_URL","VITE_CONFIDENCE_API_BASE_URL","confidenceApiClient","token","localStorage","getItem","Authorization","correlationId","random","substr","status","removeItem","DEFAULT_WEIGHTS","safetyIndex","weatherStability","transportAccessibility","languageCompatibility","healthEmergency","budgetMatch","crowdDensity","preferenceAlignment","DESTINATION_CONFIDENCE_DATA","bengaluru","tokyo","bali","santorini","iceland","getMockConfidenceScore","destinationId","_userId","resolve","setTimeout","factorScores","score","weights","finalWeights","max","calculateConfidenceScore","badge","mapScoreToBadge","breakdown","factorExplanations","factorNames","Object","entries","key","factorKey","weight","factorName","contribution","explanation","createFactorBreakdown","_score","topFactors","sort","a","b","slice","f","topFactorsText","Low","Moderate","High","Excellent","generateScoreExplanation","calculatedAt","toISOString","ttl","ConfidenceBadge","showMeter","tabIndex","onKeyPress","e","round","width","ConfidenceBreakdownModal","onClose","handleEscape","addEventListener","removeEventListener","body","overflow","badgeColors","stopPropagation","id","borderColor","factor","index","toFixed","INTERACTIONS_KEY","trackImplicitSignal","signal","interactions","stored","JSON","parse","getInteractions","push","timestamp","shift","setItem","stringify","DestinationCard","description","imageUrl","vrPreviewUrl","onPlanTrip","onVRPreview","showBreakdown","setShowBreakdown","userId","setScore","setLoading","fetchScore","err","Error","refetch","useConfidenceScore","viewStartTime","action","duration","VRModal","vrUrl","isOpen","modalRef","iframeRef","handleEscapeKey","event","focus","target","currentTarget","title","allowFullScreen","allow","sandbox","DestinationGrid","destinations","vrModalOpen","setVrModalOpen","currentVrUrl","setCurrentVrUrl","handleVRPreview"],"mappings":"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"}